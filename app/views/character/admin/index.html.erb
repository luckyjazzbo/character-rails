<!DOCTYPE html>

<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->

<head>
  <meta charset="utf-8" />

  <!-- Set the viewport width to device width for mobile -->
  <meta name="viewport" content="width=device-width" />

  <title><%= ENV['WEBSITE_NAME'] %> :: Admin</title>

  <%= stylesheet_link_tag 'admin', :media => 'all' %>

  <!-- Custom Modernizr for Foundation -->
  <%#= javascript_include_tag "foundation/modernizr.foundation.js" %>

  <%= csrf_meta_tags %>

  <%= javascript_include_tag 'admin' %>
  <%= setup_browserid %>
</head>

<body>
<% if authenticated? %>
  <header class='chr-header'>
    <div class='fixed'>
      <nav class='top-bar'>
        <ul>
          <li class='name'><h1><a href='/' target=_blank><%= ENV['WEBSITE_NAME'] %></a></h1></li>
          <li class='toggle-topbar'><a href="#"></a></li>
        </ul>
        <section>
          <ul class='left chr-main-menu' id='main_menu'>
          </ul>

          <ul class='right'>
            <li><%= logout_link %></li>
          </ul>
        </section>
      </nav>
    </div>
  </header>

  <div id='character'></div>

  <script type='text/javascript'>
    $(function(){

      window.workspace  = new Character();
      window.blog       = new Character.Blog({ blog_url: window.blog_url });
      window.pages      = new Character.Pages();

      window.workspace.apps['blog']   = window.blog;
      window.workspace.apps['pages']  = window.pages;


      <% @admin_models.each do |cls| %>
        <%= "window.workspace.apps['#{ cls.admin_title }'] = new Character.Generic.App({ title: '#{ cls.admin_title }', model_name: '#{ cls.name }', reorderable: #{ cls.admin_reorderable? }, render_item_options: #{ cls.admin_render_item_options }});".html_safe %>
        <%= %>
      <% end %>

      window.workspace.launch();
    });
  </script>
<% else %>
  
  <div class='chr-login-box' style='text-align:center; margin-top:5em;'>
    <p>Welcome to <strong>DryWired</strong> administration spot,<br>
      <%= login_link %>
    </p>
  </div>

<% end %>

</body>
</html>
